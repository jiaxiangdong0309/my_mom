# 搜索执行手册

当读取到此文档时，请立即按以下三个步骤执行搜索任务：

## 第一步：判断搜索方式

基于用户输入，从以下两种方式中二选一：

| 方式 | 判定逻辑 | 输入处理要求 | 执行脚本 |
| :--- | :--- | :--- | :--- |
| **全文检索 (FTS)** | 包含特定术语、代码、专有名词（如："Python", "MCP"） | **必须**提取核心关键词，去除语气词 | `query_db.py` |
| **语义搜索 (Vector)** | 描述性意图、自然语言提问、模糊概念 | **必须**将用户查询补充为完整的提问句 | `query_vector.py` |

---

## 第二步：执行搜索指令

所有脚本路径必须基于 `Base directory` 解析。

### 发送搜索请求
- **全文检索**: `python3 {Base directory}/search/sqlite-search/query_db.py "提取的关键词"`
- **语义搜索**: `python3 {Base directory}/search/vector-search/query_vector.py "完善后的提问句"`

---

## 第三步：返回搜索结果 (TERMINATION RULE)

根据脚本输出执行对应的返回动作。**CRITICAL**: 执行完脚本后，AI 必须进入“静默结果模式”，严禁进行任何方案推演、二次创作或建议：

1. **有匹配内容**:
   - 仅提取并展示结果中的 **标题** 和 **内容**。
   - **NEVER**: 严禁输出 JSON 原始结构，严禁添加任何开场白、结尾陈述或“基于此内容的分析建议”。

2. **无匹配内容 (空数组)**:
   - 若刚才使用“全文检索”，回复：`没有相关内容，是否切换“向量语义搜索”尝试？`
   - 若刚才使用“语义搜索”，回复：`没有相关内容，是否切换“全文检索”尝试？`
   - **NEVER**: 严禁利用 AI 自身知识库尝试回答原本需要从知识库中检索的问题。

3. **执行出错**:
   - **连接失败**: 若返回 `无法连接到后端服务` 错误，必须立即停止任务，仅回复：`请运行 mymem start 开启服务，开启后向我发送 done 指令，我将继续完成操作`。
   - **其他错误**: 直接返回脚本输出的 Error JSON，严禁尝试解释错误或提供修复建议。

---

## 路径规则 (CRITICAL)
- 始终使用相对路径配合 `Base directory` 动态解析。
- `Base directory` 示例：`/path/to/.claude/skills/query-knowledge-base`
